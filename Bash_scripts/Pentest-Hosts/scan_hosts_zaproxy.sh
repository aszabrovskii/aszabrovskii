#!/bin/bash
##############################################################################################
# Script author                                                                              #
# Aleksandr Zabrovskii                                                                       #
# Telegram: @auditorx                                                                        #
# The script is designed to scan a list of hosts from a received request for DNS records A.  #
# The scanning is performed using zaproxy and generates reports that are sent by email.      #
##############################################################################################
REPORT=zaproxy_scan
PROTOCOL=http://
RECORD=/scripts/ResourceRecord_A/staging_list.txt

for VAR_HOST in $(< $HOME$RECORD); do
  export DIR="$VAR_HOST"

  echo "#################################################"
  echo "###############   Start Scanning   ##############"
  echo "#################################################"

 ./traking_html.sh &

  echo ${VAR_HOST} > $HOME/py_scripts/subject_web.txt

  sudo zaproxy -daemon -quickurl ${PROTOCOL}${VAR_HOST} -quickout $HOME/sh_scripts/${REPORT}.html -quickprogress

  echo "#################################################"
  echo "################   End of Scan    ###############"
  echo "#################################################"

done


exit 0
